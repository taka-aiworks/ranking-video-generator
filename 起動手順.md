# 🚀 動画生成アプリ - 起動手順

## 📋 必要な準備

### 1. 環境確認
- ✅ Node.js インストール済み
- ✅ VoiceVOX インストール済み
- ✅ ngrok 認証済み

### 2. 依存関係インストール
```bash
npm install
```

## 🎯 起動方法

### 方法1: バッチファイル使用（推奨）

#### 1. 完全起動
```bash
START_SERVERS.bat
```
- Irasutoya画像サーバー
- Vite開発サーバー
- VoiceVOX
- ngrok（VoiceVOX外部公開）

#### 2. ngrok URL取得
```bash
GET_NGROK_URL.bat
```

### 方法2: 手動起動

#### ターミナル1: Irasutoya画像サーバー
```bash
node server/index.js
```

#### ターミナル2: Vite開発サーバー
```bash
npm run dev
```

#### ターミナル3: VoiceVOX
- VoiceVOXアプリを起動

#### ターミナル4: ngrok
```bash
ngrok.exe http 50021
```

## 🌐 アクセス方法

### ローカルアクセス
- **フロントエンド**: http://localhost:5173
- **Irasutoya画像**: http://localhost:3001
- **VoiceVOX**: http://localhost:50021

### 他のデバイスからアクセス
- **フロントエンド**: http://192.168.2.186:5173
- **Irasutoya画像**: http://192.168.2.186:3001
- **VoiceVOX**: ngrok URL（例: https://xxxxx.ngrok-free.dev）

## 🔧 VoiceVOX設定

### 1. ngrok URLを取得
```bash
GET_NGROK_URL.bat
```

### 2. アプリケーションで設定
1. ブラウザで http://192.168.2.186:5173 にアクセス
2. 「ngrok設定」ボタンをクリック
3. ページを再読み込み
4. 「接続確認」ボタンでテスト

## 📊 サーバー状況確認

### ポート確認
```bash
netstat -ano | findstr ":3001"  # Irasutoya画像サーバー
netstat -ano | findstr ":5173"  # Vite開発サーバー
netstat -ano | findstr ":50021" # VoiceVOX
```

### 接続テスト
- **Irasutoya**: http://localhost:3001/api/health
- **VoiceVOX**: http://localhost:50021/speakers
- **ngrok**: http://localhost:4040

## 🛠️ トラブルシューティング

### よくある問題

#### 1. ポートが使用中
```bash
taskkill /F /IM node.exe
```

#### 2. ngrok認証エラー
```bash
ngrok.exe config add-authtoken YOUR_TOKEN
```

#### 3. VoiceVOX接続エラー
- VoiceVOXアプリが起動しているか確認
- ngrok URLが正しく設定されているか確認

## 📝 使用手順

### 1. サーバー起動
```bash
START_SERVERS.bat
```

### 2. ngrok URL取得
```bash
GET_NGROK_URL.bat
```

### 3. アプリケーション設定
1. ブラウザでアクセス
2. 「ngrok設定」でURL設定
3. 接続確認

### 4. 動画生成
1. キーワード入力
2. スクリプト生成
3. 画像選択
4. 動画生成

## ⚠️ 注意事項

- ngrok URLは再起動のたびに変更されます
- 他のデバイスからアクセスする場合は、毎回ngrok URLを再設定してください
- サーバーを停止する場合は、各ウィンドウを閉じてください

## 🔄 再起動手順

1. すべてのウィンドウを閉じる
2. `START_SERVERS.bat` を実行
3. `GET_NGROK_URL.bat` で新しいURLを取得
4. アプリケーションで新しいURLを設定
